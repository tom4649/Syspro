実行結果は
measure1:
1バイト:72613624 ns
8192バイト:5932729 ns
measure2:
1バイト:533116452 ns
8192バイト:6351708 ns
となった。
読み込むバイト数が8192バイトのときはmeasure1,measure2で大きな差はなかったが、1バイトのときにはmeasure2の方が実行時間が短かった。
straceコマンドを用いて調べてみると、読み込むバイト数が1バイトのとき、measure1では1バイトずつシステムコールread,writeを繰り返していたのに対して、
measure2では4096バイトずつread,writeを行っていた。
また読み込むバイト数が8192バイトのときはmeasure1ではread,writeともに8192バイトずつ行われていたのに対して、
measure2ではreadが8192バイト、writeが4096バイトずつ行われていた。
以上のことから、freadやfwriteなどの高水準入出力ライブラリにはバッファを用いることでコストの大きいシステムコールを呼ぶ回数を減らす仕組みが備わっており、
それが実行時間の差異の理由となったと考えられる。